# サーバーレスとは

- **ざっくり概要把握**
  - サーバーレスはサーバーがないという事ではない
  - サーバーレス = サーバーレスコンピューティング, サーバーレスアーキテクチャ
  - サーバーレスはクラウドベンダーで提供されるサービス

## 1. サーバーレスの詳細把握

参照: [サーバーレス・コンピューティング](https://ja.wikipedia.org/wiki/%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%B9%E3%83%BB%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0)

> サーバーレス・コンピューティング（Serverless computing）とは、クラウド・プロバイダーがアプリケーションに必要なマシン・リソースの割り当てを動的に管理し、事前に購入されたことに基づく請求ではなく、各アプリケーション要求を満たすために使用される個々のリソース量に基づいた請求を行うようなクラウド・コンピューティングの実行モデルである。

- サーバーレスはクラウドベンダーで提供されるサービス
  - ユーザが各アプリケーションを動かす際に使用した分のリソースだけを支払う従量課金制

> 物理サーバーがアプリケーション・コードを提供するユーザーの視点から完全に抽象化されているため、「サーバーレス・コンピューティング」という名前が使用される。

- ユーザがサーバのことを全く気にしなくて良いという所がサーバーレス(コンピューティング)の由来
  - 開発においてユーザはサーバの運用・管理から解放される
  - より多くのリソースを開発に割くことができる

> サーバーレス・コードは、マイクロサービスなど従来のサーバー・スタイルで書かれたコードと組み合わせて使用できる。 たとえば、Webアプリケーションの一部をマイクロ・サービスとして記述し、別の部分をサーバーレス・コードとして記述することができる。 あるいは、プロビジョニングされたサーバーをまったく使用せず、完全にサーバーレスであるアプリケーションを作成することもできる。

**なんとなく**言わんとする事は分かる。

## 2. サーバーレスの歴史

参照: [ゼロからサーバレスの先端に追いつこう #1/2](https://logmi.jp/tech/articles/314329)
参照: [ゼロからサーバレスの先端に追いつこう #2/2](https://logmi.jp/tech/articles/314348)

### 2-1. 2014年代~

サーバーレスアーキテクチャと言われるものの始まりと言えるのが、2014年 AWS Lambdaが発表された時。

- AWS Lambda
AWS内のイベントをトリガーにしてクラウドに登録しておいた関数が実行されるという仕組みを提供するサービス。

例えば、Amazon S3でファイルをアップロード時に「S3にファイルがアップロードされた」というPUT通知がトリガーイベントとして通知される。それをトリガーとしてAWS Lambdaが起動すると、AWS Lambdaに登録しておいた関数が実行されて、処理を終えたらサーバが破棄される、というのが一番ベーシックなAWS Lambdaの実行イメージである。

- **AWS Lambdaの利点**

1. "**Easy to Use and Low Maintenance**"
（簡単に使えて、メンテナンスコストが低く利用できる）

- 簡単に使える
  - インフラについて考える必要がなくなる
  - メンテナンスコストが低く利用出来る

2. "**Very Rapid Responses to Event**"
（イベントに対して素早く反応するところ）

- イベントに対してミリ秒単位で素早く反応し、関数が実行される
S3以外にもDynamo DBというデータベースや、Kinesisというストリームをするための仕組みでも使用できる。イベントソースはさまざまある。

- この頃はまだアーキテクチャの名称が定まっていなかった
現在はFaaS（Function as a Service）と呼ばれているが、当時はDynamic Computing, Serverless Architecture/Computingとも呼ばれていた。

現在のServerless Architectureという呼ばれ方は、AWS Lambdaだけでなく、**サーバの存在を感じさせないアーキテクチャの総称**として利用される。

### 2-2. 2015年代~

2015年6月、発表から半年ほど経って、AWS Lambdaが東京リージョンで利用できるようになった。

同じく6月、AWS LambdaにJavaが利用できるようになった(当初はNodeのみ)

2015年7月、AWS LambdaのイベントソースにDynamoDBを指定できるようになった。

同じく7月、API Gatewayのサービスが発表。
これはRESTful APIを定義し、その定義したRESTful APIのエンドポイントに対してHTTPでアクセスをすると、そのアクセスしてきたエンドポイントにバインドされたLambdaが起動される、というサービス。

2015年10月、JAWS Frameworkというアプリケーショフレームワークが公開される。**現在のServerless Frameworkの前身**。

### 2-3. 流れの整理

ざっと見た感じをまとめる。

1. AWS Lambdaの登場
2. Lambdaのイベントソースが続々と発表になる
3. Eventsを使って非同期処理を組み込むようなサービスも増えていき、設計の幅が広がっていく。

## 3. サーバーレスを利用する利点

### 3-1. スケーラビリティ/可用性

- サーバーレスの実行環境
コンテナが定期的に破棄されるという仕組みの制約上、システムというのは状態を持ってはいけない。アップロードしたファンクションはそのアップロードしたときから不変であることから、FaaSを使うと絶対にImmutableでStatelessなシステムになる。

- ImmutableでStatelessなシステムの利点
  - 分散処理が出来るようになる。
状態を持っているサーバがないので、状態が変わって、同じ状態の変化がないコードがデプロイされたコンテナがたくさんあれば分散処理が可能となる。

つまり、サーバが1個消えたところで何も影響がないという点で可用性が高いということになる。

### 3-2. 保守性

インフラの保守管理をすべてクラウドベンダーに任せられる点が、非常に大きなメリット。

### 3-3. 価格優位性

サーバーレスの場合、実際に関数が実行された時間に対して課金されるので、価格的に非常に最適化ができる。Lambdaの関数実行時の価格は128MBあたりいくらという形だが、、割り当てるコンテナのメモリ容量をファンクション単位で設定ができる。
「このファンクションはメモリをいっぱい必要とするからメモリを大きく割り当てよう」という設定が可能。

## 4. サーバーレスの課題

### 4-1. 
